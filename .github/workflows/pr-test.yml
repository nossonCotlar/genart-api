name: PR Testing

env: 
  
  AWS_ACCOUNT_ID: 901024526765
  

on: 
  pull_request: 
    branches: [feature/actions-testing]

jobs: 
  Testing: 
    runs-on: ubuntu-20.04
    steps: 
      
      - uses: actions/checkout@v2
        name: Checkout current repo
        with:
          path: main

      - uses: actions/checkout@v2
        name: Checkout Make Scripts
        with: 
          repository: MacroFab/Makeinclude
          path: MakeInclude
          token: ${{secrets.PERSONAL_ACCESS_TOKEN}}

      # - name: Run Make Container
      #   run: | 
      #     cd main
      #     make container


      - name: Check Issue number
        run: echo ${{github.event.number}}

      - name: Make Comment
        run: | 
          cat > comment.json <<EOF
          {
            "body": 
            "# This is some **Markdown** stuff\n 
            ## This is being sent through the API - we'll see how bad it is\n
            ### Lets see how code coverage went:\n
            ![Coverage Badge](https://img.shields.io/badge/coverage-100%25-green)"
          }
          EOF

      - name: Post Comment
        run: |
          cat comment.json

          curl -X POST "https://api.github.com/repos/${{github.repository}}/issues/${{github.event.number}}/comments" -H "Authorization: token ${{secrets.GITHUB_TOKEN}}" -H "Content-Type: application/json" -d "@comment.json"
        # uses: peter-evans/create-or-update-comment@v1.4.4
        # with: 
        #   issue-number: ${{github.event.number}}
        #   body: | 
        #     # This is some **Markdown** stuff
        #     ## Lets see how code coverage went:
        #     ![Coverage Badge](https://img.shields.io/badge/coverage-100%25-green)